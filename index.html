<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ball vs. Beam Squares</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; background: #222; }
    #score {
      position: absolute;
      top: 10px;
      right: 20px;
      color: white;
      font-size: 24px;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="score">Score: 0</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let ball = { x: canvas.width / 2 + 10, y: canvas.height / 2, radius: 20, color: 'white' };
let bullets = [];
let squares = [];
let score = 0;
let canShoot = true;
let gameOver = false;

function drawBall() {
  ctx.fillStyle = ball.color;
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
  ctx.fill();
}

function drawSquares() {
  ctx.fillStyle = 'red';
  squares.forEach(square => ctx.fillRect(square.x, square.y, square.size, square.size));
}

function drawBeams() {
  bullets.forEach(bullet => {
    ctx.strokeStyle = 'rgba(128, 0, 128, 0.8)';
    ctx.lineWidth = 20;
    ctx.beginPath();
    ctx.moveTo(ball.x, ball.y);
    ctx.lineTo(bullet.targetX, bullet.targetY);
    ctx.stroke();
  });
}

function updateSquares() {
  squares.forEach(square => {
    square.x += square.dx;
    square.y += square.dy;
  });
}

function spawnSquare() {
  const size = 40;
  let square = { size };
  const edge = Math.floor(Math.random() * 4);

  if (edge === 0) {
    square.x = ball.x;
    square.y = -size;
    square.dx = 0;
    square.dy = 2;
  } else if (edge === 1) {
    square.x = ball.x;
    square.y = canvas.height;
    square.dx = 0;
    square.dy = -2;
  } else if (edge === 2) {
    square.x = -size;
    square.y = ball.y;
    square.dx = 2;
    square.dy = 0;
  } else {
    square.x = canvas.width;
    square.y = ball.y;
    square.dx = -2;
    square.dy = 0;
  }

  squares.push(square);
}

function checkCollisions() {
  squares = squares.filter(square => {
    let hit = bullets.some(bullet => {
      return bullet.direction === 'horizontal'
        ? square.y >= ball.y - 10 && square.y <= ball.y + 10
        : square.x >= ball.x - 10 && square.x <= ball.x + 10;
    });
    if (hit) {
      score++;
      document.getElementById('score').innerText = `Score: ${score}`;
      return false;
    }
    return true;
  });
}

function shoot(direction) {
  if (!canShoot) return;
  canShoot = false;
  setTimeout(() => canShoot = true, 250);

  ball.color = 'rgba(128, 0, 128, 1)';
  setTimeout(() => ball.color = 'white', 100);

  let targetX = direction === 'ArrowLeft' ? 0 : direction === 'ArrowRight' ? canvas.width : ball.x;
  let targetY = direction === 'ArrowUp' ? 0 : direction === 'ArrowDown' ? canvas.height : ball.y;

  bullets.push({
    direction: direction === 'ArrowLeft' || direction === 'ArrowRight' ? 'horizontal' : 'vertical',
    targetX, targetY
  });
  setTimeout(() => bullets.shift(), 150);
}

function gameLoop() {
  if (gameOver) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBall();
  drawSquares();
  drawBeams();
  updateSquares();
  checkCollisions();

  requestAnimationFrame(gameLoop);
}

setInterval(spawnSquare, 500);
window.addEventListener('keydown', (e) => shoot(e.key));

gameLoop();
</script>
</body>
</html>
