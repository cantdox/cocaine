<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ball vs. Squares</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; background: #222; }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let ball = { x: canvas.width / 2, y: canvas.height / 2, radius: 20 };
let bullets = [];
let squares = [];
let spawnInterval = 1000;
let gameOver = false;

function drawBall() {
  ctx.fillStyle = 'white';
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
  ctx.fill();
}

function drawBullets() {
  ctx.fillStyle = 'yellow';
  bullets.forEach(bullet => ctx.fillRect(bullet.x, bullet.y, bullet.size, bullet.size));
}

function drawSquares() {
  ctx.fillStyle = 'red';
  squares.forEach(square => ctx.fillRect(square.x, square.y, square.size, square.size));
}

function updateBullets() {
  bullets.forEach(bullet => {
    bullet.x += bullet.dx;
    bullet.y += bullet.dy;
  });
  bullets = bullets.filter(bullet => bullet.x > 0 && bullet.x < canvas.width && bullet.y > 0 && bullet.y < canvas.height);
}

function spawnSquare() {
  const size = 40;
  let square = { size };
  const edge = Math.floor(Math.random() * 4);

  if (edge === 0) { // Top
    square.x = Math.random() * canvas.width;
    square.y = -size;
    square.dx = 0;
    square.dy = 2;
  } else if (edge === 1) { // Bottom
    square.x = Math.random() * canvas.width;
    square.y = canvas.height;
    square.dx = 0;
    square.dy = -2;
  } else if (edge === 2) { // Left
    square.x = -size;
    square.y = Math.random() * canvas.height;
    square.dx = 2;
    square.dy = 0;
  } else { // Right
    square.x = canvas.width;
    square.y = Math.random() * canvas.height;
    square.dx = -2;
    square.dy = 0;
  }

  squares.push(square);
}

function updateSquares() {
  squares.forEach(square => {
    square.x += square.dx;
    square.y += square.dy;
  });
}

function checkCollisions() {
  squares.forEach((square, i) => {
    if (Math.hypot(ball.x - (square.x + square.size / 2), ball.y - (square.y + square.size / 2)) < ball.radius + square.size / 2) {
      gameOver = true;
      alert("Game Over! Refresh to try again.");
    }

    bullets.forEach((bullet, j) => {
      if (bullet.x < square.x + square.size && bullet.x + bullet.size > square.x &&
          bullet.y < square.y + square.size && bullet.y + bullet.size > square.y) {
        bullets.splice(j, 1);
        squares.splice(i, 1);
      }
    });
  });
}

function shoot(direction) {
  let bullet = { x: ball.x, y: ball.y, size: 10, dx: 0, dy: 0 };
  if (direction === 'ArrowUp') bullet.dy = -5;
  if (direction === 'ArrowDown') bullet.dy = 5;
  if (direction === 'ArrowLeft') bullet.dx = -5;
  if (direction === 'ArrowRight') bullet.dx = 5;
  bullets.push(bullet);
}

function gameLoop() {
  if (gameOver) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBall();
  drawBullets();
  drawSquares();
  updateBullets();
  updateSquares();
  checkCollisions();

  requestAnimationFrame(gameLoop);
}

setInterval(spawnSquare, spawnInterval);
window.addEventListener('keydown', (e) => shoot(e.key));

gameLoop();
</script>
</body>
</html>
